# 扫码登录

## APP 认证机制

- 初次登录，会向服务端发送账号密码、设备信息（每台设备的信息都是唯一的）
- 账号密码校验通过，服务端会把账号与设备进行一个绑定，进行持久化的保存
- APP 后续每次请求除了携带token，还需要携带设备信息

![](https://cdn.jsdelivr.net/gh/kingmusi/blogImages/img/202205032108174.svg)

## 扫码认证机制

- PC 访问登录页面，请求服务端获取`二维码ID`
- 服务端生成相应的`二维码ID`，设置二维码的过期时间，状态等
- PC 获取`二维码ID`，生成相应的二维码
- 手机端扫描二维码，获取`二维码ID`
- 手机端将`手机端token`和`二维码ID`发送给服务端，确认登录
- 服务端校验`手机端token`，根据`手机端token`和`二维码ID`生成`PC端token`
- PC端通过轮询方式请求服务端，通过`二维码ID`获取二维码状态，如果已成功，返回`PC  token`，登录成功，如果超时，则重新请求二维码 ID

![](https://cdn.jsdelivr.net/gh/kingmusi/blogImages/img/202205032110666.svg)