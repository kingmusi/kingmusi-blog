# è¾“å…¥æ¡†

## TextField

#### å±æ€§

```dart
const TextField({
  ...
  TextEditingController controller, 
  FocusNode focusNode,
  InputDecoration decoration = const InputDecoration(),
  TextInputType keyboardType,
  TextInputAction textInputAction,
  TextStyle style,
  TextAlign textAlign = TextAlign.start,
  bool autofocus = false,
  bool obscureText = false,
  int maxLines = 1,
  int maxLength,
  this.maxLengthEnforcement,
  ToolbarOptions? toolbarOptions,
  ValueChanged<String> onChanged,
  VoidCallback onEditingComplete,
  ValueChanged<String> onSubmitted,
  List<TextInputFormatter> inputFormatters,
  bool enabled,
  this.cursorWidth = 2.0,
  this.cursorRadius,
  this.cursorColor,
  this.onTap,
  ...
})
```

- `controller`ï¼šç¼–è¾‘æ¡†çš„æ§åˆ¶å™¨ï¼Œé€šè¿‡å®ƒå¯ä»¥è®¾ç½®/è·å–ç¼–è¾‘æ¡†çš„å†…å®¹ã€é€‰æ‹©ç¼–è¾‘å†…å®¹ã€ç›‘å¬ç¼–è¾‘æ–‡æœ¬æ”¹å˜äº‹ä»¶
- `focusNode`ï¼šç”¨äºæ§åˆ¶`TextField`æ˜¯å¦å æœ‰å½“å‰é”®ç›˜çš„è¾“å…¥ç„¦ç‚¹ã€‚å®ƒæ˜¯æˆ‘ä»¬å’Œé”®ç›˜äº¤äº’çš„ä¸€ä¸ªå¥æŸ„
- `InputDecoration`ï¼šç”¨äºæ§åˆ¶`TextField`çš„å¤–è§‚æ˜¾ç¤ºï¼Œå¦‚æç¤ºæ–‡æœ¬ã€èƒŒæ™¯é¢œè‰²ã€è¾¹æ¡†ç­‰
- `keyboardType`ï¼šç”¨äºè®¾ç½®è¯¥è¾“å…¥æ¡†é»˜è®¤çš„é”®ç›˜è¾“å…¥ç±»å‹ï¼Œå–å€¼å¦‚ä¸‹ï¼š

| TextInputTypeæšä¸¾å€¼ | å«ä¹‰                                                |
| ------------------- | --------------------------------------------------- |
| text                | æ–‡æœ¬è¾“å…¥é”®ç›˜                                        |
| multiline           | å¤šè¡Œæ–‡æœ¬ï¼Œéœ€å’ŒmaxLinesé…åˆä½¿ç”¨(è®¾ä¸ºnullæˆ–å¤§äº1)     |
| number              | æ•°å­—ï¼›ä¼šå¼¹å‡ºæ•°å­—é”®ç›˜                                |
| phone               | ä¼˜åŒ–åçš„ç”µè¯å·ç è¾“å…¥é”®ç›˜ï¼›ä¼šå¼¹å‡ºæ•°å­—é”®ç›˜å¹¶æ˜¾ç¤ºâ€œ* #â€ |
| datetime            | ä¼˜åŒ–åçš„æ—¥æœŸè¾“å…¥é”®ç›˜ï¼›Androidä¸Šä¼šæ˜¾ç¤ºâ€œ: -â€          |
| emailAddress        | ä¼˜åŒ–åçš„ç”µå­é‚®ä»¶åœ°å€ï¼›ä¼šæ˜¾ç¤ºâ€œ@ .â€                   |
| url                 | ä¼˜åŒ–åçš„urlè¾“å…¥é”®ç›˜ï¼› ä¼šæ˜¾ç¤ºâ€œ/ .â€                   |

- `textInputAction`ï¼šé”®ç›˜åŠ¨ä½œæŒ‰é’®å›¾æ ‡(å³å›è½¦é”®ä½å›¾æ ‡)ï¼Œå®ƒæ˜¯ä¸€ä¸ªæšä¸¾å€¼ï¼Œæœ‰å¤šä¸ªå¯é€‰å€¼ï¼Œå…¨éƒ¨çš„å–å€¼åˆ—è¡¨è¯»è€…å¯ä»¥æŸ¥çœ‹APIæ–‡æ¡£ï¼Œä¸‹é¢æ˜¯å½“å€¼ä¸º`TextInputAction.search`æ—¶ï¼ŒåŸç”ŸAndroidç³»ç»Ÿä¸‹é”®ç›˜æ ·å¼

![](https://cdn.jsdelivr.net/gh/kingmusi/blogImages//img/20220106141743.png)

- `style`ï¼šæ­£åœ¨ç¼–è¾‘çš„æ–‡æœ¬æ ·å¼
- `textAlign`: è¾“å…¥æ¡†å†…ç¼–è¾‘æ–‡æœ¬åœ¨æ°´å¹³æ–¹å‘çš„å¯¹é½æ–¹å¼
- `autofocus`: æ˜¯å¦è‡ªåŠ¨è·å–ç„¦ç‚¹
- `obscureText`ï¼šæ˜¯å¦éšè—æ­£åœ¨ç¼–è¾‘çš„æ–‡æœ¬ï¼Œå¦‚ç”¨äºè¾“å…¥å¯†ç çš„åœºæ™¯ç­‰ï¼Œæ–‡æœ¬å†…å®¹ä¼šç”¨â€œâ€¢â€æ›¿æ¢
- `maxLines`ï¼šè¾“å…¥æ¡†çš„æœ€å¤§è¡Œæ•°ï¼Œé»˜è®¤ä¸º1ï¼›å¦‚æœä¸º`null`ï¼Œåˆ™æ— è¡Œæ•°é™åˆ¶
- `maxLength`å’Œ`maxLengthEnforcement` ï¼š`maxLength`ä»£è¡¨è¾“å…¥æ¡†æ–‡æœ¬çš„æœ€å¤§é•¿åº¦ï¼Œè®¾ç½®åè¾“å…¥æ¡†å³ä¸‹è§’ä¼šæ˜¾ç¤ºè¾“å…¥çš„æ–‡æœ¬è®¡æ•°ã€‚`maxLengthEnforcement`å†³å®šå½“è¾“å…¥æ–‡æœ¬é•¿åº¦è¶…è¿‡`maxLength`æ—¶å¦‚ä½•å¤„ç†ï¼Œå¦‚æˆªæ–­ã€è¶…å‡ºç­‰
- `toolbarOptions`ï¼šé•¿æŒ‰æˆ–é¼ æ ‡å³å‡»æ—¶å‡ºç°çš„èœå•ï¼ŒåŒ…æ‹¬ copyã€cutã€paste ä»¥åŠ selectAll
- `onChange`ï¼šè¾“å…¥æ¡†å†…å®¹æ”¹å˜æ—¶çš„å›è°ƒå‡½æ•°
- `onEditingComplete`å’Œ`onSubmitted`ï¼šè¿™ä¸¤ä¸ªå›è°ƒéƒ½æ˜¯åœ¨è¾“å…¥æ¡†è¾“å…¥å®Œæˆæ—¶è§¦å‘ï¼Œæ¯”å¦‚æŒ‰äº†é”®ç›˜çš„å®Œæˆé”®ï¼ˆå¯¹å·å›¾æ ‡ï¼‰æˆ–æœç´¢é”®ï¼ˆğŸ”å›¾æ ‡ï¼‰ã€‚ä¸åŒçš„æ˜¯ä¸¤ä¸ªå›è°ƒç­¾åä¸åŒï¼Œ`onSubmitted`å›è°ƒæ˜¯`ValueChanged<String>`ç±»å‹ï¼Œå®ƒæ¥æ”¶å½“å‰è¾“å…¥å†…å®¹åšä¸ºå‚æ•°ï¼Œè€Œ`onEditingComplete`ä¸æ¥æ”¶å‚æ•°
- `inputFormatters`ï¼šç”¨äºæŒ‡å®šè¾“å…¥æ ¼å¼ï¼›å½“ç”¨æˆ·è¾“å…¥å†…å®¹æ”¹å˜æ—¶ï¼Œä¼šæ ¹æ®æŒ‡å®šçš„æ ¼å¼æ¥æ ¡éªŒ
- `enable`ï¼šå¦‚æœä¸º`false`ï¼Œåˆ™è¾“å…¥æ¡†ä¼šè¢«ç¦ç”¨ï¼Œç¦ç”¨çŠ¶æ€ä¸æ¥æ”¶è¾“å…¥å’Œäº‹ä»¶ï¼ŒåŒæ—¶æ˜¾ç¤ºç¦ç”¨æ€æ ·å¼
- `cursorWidth`ã€`cursorRadius`å’Œ`cursorColor`ï¼šè¿™ä¸‰ä¸ªå±æ€§æ˜¯ç”¨äºè‡ªå®šä¹‰è¾“å…¥æ¡†å…‰æ ‡å®½åº¦ã€åœ†è§’å’Œé¢œè‰²çš„

```dart
TextField(
  decoration: InputDecoration(
    labelText: "ç”¨æˆ·å",
    hintText: "ç”¨æˆ·åæˆ–é‚®ç®±",
    prefixIcon: Icon(Icons.person)
  ),
)
```

## ç›‘å¬æ–‡æœ¬å˜åŒ–å¹¶è·å–è¾“å…¥å†…å®¹

#### onChanged

1. å®šä¹‰ä¸€ä¸ª **String** ç±»å‹çš„å˜é‡

```dart
String value = '';
```

2. è®¾ç½® `onChanged`  å›è°ƒ

```dart
TextField(
    onChanged: (v) {
      setState(){
        value = v;
      };
    }
)
```

#### controller

1. å®šä¹‰ä¸€ä¸ª `controller`

```dart
TextEditingController _controller = TextEditingController();
```

2. è®¾ç½®è¾“å…¥æ¡†

```dart
TextField(
    controller: _controller, 
    ...
)
```

3. é€šè¿‡ controller ç›‘å¬

```dart
@override
void initState() {
  _controller.addListener((){
    print(_controller.text);
  });
}
```

4. ç›´æ¥è·å–æ–‡æœ¬

```dart
print(_controller.text);
```

> ä¸¤ç§æ–¹å¼ç›¸æ¯”ï¼Œ`onChanged`æ˜¯ä¸“é—¨ç”¨äºç›‘å¬æ–‡æœ¬å˜åŒ–ï¼Œè€Œ`controller`çš„åŠŸèƒ½å´å¤šä¸€äº›ï¼Œé™¤äº†èƒ½ç›‘å¬æ–‡æœ¬å˜åŒ–å¤–ï¼Œå®ƒè¿˜å¯ä»¥è®¾ç½®é»˜è®¤å€¼ã€é€‰æ‹©æ–‡æœ¬
>
> ```dart
> _controller.text = 'hello world';
> _controller.selection = TextSelection(
>   	baseOffset: 2,
>   	extentOffset: _controller.text.length
> );
> ```
>
> ![](https://cdn.jsdelivr.net/gh/kingmusi/blogImages//img/20220106143550.png)

## ç„¦ç‚¹

ä½¿ç”¨ `FocusNode` ç»‘å®šè¾“å…¥æ¡†çš„ç„¦ç‚¹

ä½¿ç”¨ `FocusScopeNode` ç®¡ç† **widget** æ ‘çš„ç„¦ç‚¹

```dart
class _FocusState extends State<HomePage> {
  FocusNode focusNode = FocusNode();
  FocusScopeNode? focusScopeNode;

  @override
  Widget build(BuildContext context) {
    return TextField(
      decoration: InputDecoration(
        labelText: "input",
      ),
      focusNode: focusNode,
    );
  }
}
```

#### è¾“å…¥æ¡†è·å–ç„¦ç‚¹

```dart
ElevatedButton(
  onPressed: () {
    if (focusScopeNode == null) {
      focusScopeNode = FocusScope.of(context);
    }
    focusScopeNode?.requestFocus(focusNode);
  },
  child: Text('è·å–ç„¦ç‚¹'),
)
```

#### å¤±å»ç„¦ç‚¹

```dart
ElevatedButton(
  onPressed: () => focusNode.unfocus(),
  child: Text('å¤±å»ç„¦ç‚¹'),
)
```

> å½“æ‰€æœ‰é¡µé¢ç¼–è¾‘æ¡†çš„ç„¦ç‚¹éƒ½å¤±å»ï¼Œé”®ç›˜ä¼šè‡ªåŠ¨æ”¶èµ·

#### ç›‘å¬ç„¦ç‚¹çŠ¶æ€æ”¹å˜

è·å¾—ç„¦ç‚¹æ—¶`focusNode.hasFocus`å€¼ä¸º`true`ï¼Œå¤±å»ç„¦ç‚¹æ—¶ä¸º`false`

```dart
focusNode.addListener((){
   print(focusNode.hasFocus);
});
```



