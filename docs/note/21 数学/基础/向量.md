# 向量

## 定义

向量是一种同时具有大小和方向的物理量

同时具有大小和方向的物理量称为向量值物理量。常见的向量值物理量有：力（在某个特定方向上施加一定的作用力——量值），位移（在某个净方向上移动一段距离），速度（速率和方向）。因此，向量可以用来表示力、位移和速度。有时我们也用向量来表示一个单个方向。

向量中的数表示了每一个维度上有方向的位移。例如，沿x轴移动3像素，沿y轴移动5像素。那么这个向量可以表达为[3,5]。

```typescript
class Vector {
    public x: number;
    public y: number;

    public constructor(x: = 0, y = 0) {
        this.x = x;
        this.y = y;
    }
}
```

## 向量的模（长度或大小）

向量的大小实际上就是所构成的直角三角形的斜边长

```typescript
public get norm(): number {
    return Math.hypot(this.x, this.y);
	// return Math.sqrt(this.x * this.x + this.y * this.y);
}
```

## 向量的平移（向量加法）

当一个物体运动时，它的运动方向与大小使用向量[2,3]来表示。此时又出现另外一个力，这个力用向量[5,1]来表示。两个力合作用在这个物体上，那么它的运动方向和大小应该是多少呢？

这种情况属于向量的平移，只需要将两个向量做加法运算即可。

```typescript
public static add(v1: Vector, v2: Vector): Vector {
	return new Vector(v1.x + v2.x, v1.y + v2.y);
}
```

## 一个点到另一个点的向量（向量减法）

计算一个点到另外一个点的位移类似于沿着一个路径移动，可以用向量减法运算来得到新向量。在几何中可以描述为，两个向量结尾相连的结果，该结果也是一个向量。

```typescript
public static subtract(v1: Vector, v2: Vector): Vector {
	return new Vector(v1.x - v2.x, v1.y - v2.y);
}
```

## 改变向量大小（向量与标量相乘）

做完乘法之后，从几何意义上来解释实际上是改变了向量的大小，而标量成为大小改变时的系数。假如我们想将一个向量的大小扩大2倍，那么直接乘以标量即可。

```typescript
public multiply(s: number): void {
	this.x *= s;
	this.y *= s;
}
```

## 向量的归一化（标准化）

很多时候我们要在游戏中使用向量来表示一个物体的方向，而不关心其大小。这样情况下使用“单位向量”将非常方便。所谓单位向量就是大小为1的向量。将一个向量变成单位向量的操作我们称之为归一化，也叫做标准化。

```typescript
public normalize(): void {
	if (this.norm === 0) {
		return;
	}
	this.multiply(1 / this.norm);
}
```

## 向量旋转

逆时针时θ为正数， 顺时针时θ为负数

推导：下标 0 代表旋转前，下标 1 代表旋转后
$$
\begin{aligned}
x0 = |R| \times cosα \\
y0 = |R| \times sinα \\
x1 = |R| \times cos(α + θ) \\
y1 = |R| \times sin(α + θ) \\
\\
x1 = |R| \times (cosαcosθ - sinαsinθ) \\
y1 = |R| \times (sinαcosθ + cosαsinθ) \\
\\
x1 = x0 \times cosθ - y0 \times sinθ \\
y1 = x0 \times sinθ + y0 \times cosθ
\end{aligned}
$$

```typescript
public rotate(angle: number): void {
    const x0 = this.x, y0 = this.y
    const cos = Math.cos(angle);
    const sin = Math.sin(andle);
	this.x = x0 * cos - y0 * sin
	this.y = x0 * sin + y0 * cos
}
```

## 向量点乘

点乘的公式表示为：`A·B`

点乘所得到的结果蕴含的信息非常重要，它反映着两个向量的“相似度”，两个向量越“相似”，它们的点乘越大。

如果 A·B = 0，那么表示两个向量互相垂直，其夹角为90度。如果 A·B < 0，则表示两个向量夹角大于90度。相反，如果 A·B > 0，那么表示两个向量夹角小于90度。

`A·B = 0, 𝛳 = 90°`

`A·B < 0, 𝛳 > 90°`

`A·B > 0, 𝛳 < 90°`

𝛳 为两个向量的夹角。

```typescript
public static dotProduct(v1: Vector, v2: Vector): number {
	return v1.x * v2.x + v1.y * v2.y;
}
```

## 计算两个向量的夹角度数

有公式如下：`A·B = A的模 × B的模 × cos𝛳`

```typescript
public static angle(v1: Vector, v2: Vector): number {
	let a = Vector.dotProduct(v1, v2);
	let b = v1.norm * v2.norm;
	let c = a / b;
	let rad = Math.acos(c);
	let deg = rad * 180 / Math.PI;
	return deg;
}
```

## 向量类中一些方便的接口

```typescript
/**
 * 复制另外一个向量的值
 */
public copy(v: Vector): void {
    this.x = v.x;
    this.y = v.y;
}

/**
 * 设置向量的值
 */
public setTo(x: number, y: number): void {
    this.x = x;
    this.y = y;
}

/**
 * 新建一个向量，Vector(1, 1)
 */
public static one(): Vector {
    return new Vector(1, 1);
}

/**
 * 新建一个向量，Vector(0, 0)
 */
public static zero(): Vector {
    return new Vector(0, 0);
}

/**
 * 新建一个向量，Vector(-1, 0)
 */
public static left(): Vector {
    return new Vector(-1, 0);
}

/**
 * 新建一个向量，Vector(1, 0)
 */
public static right(): Vector {
    return new Vector(1, 0);
}

/**
 * 新建一个向量，Vector(0, 1)
 */
public static down(): Vector {
    return new Vector(0, 1);
}

/**
 * 新建一个向量，Vector(0, -1)
 */
public static up(): Vector {
    return new Vector(0, -1);
}
```

