# 常用命令

## 分支

```shell
# 查看分支（本地）
git branch

# 查看分支（远端）
git branch -a

# 创建分支
git branch <dev-name>

# 切换分支
git checkout <dev-name>

# 创建+切换分支
git checkout -b <dev-name>

# 删除本地分支
git branch -d <dev-name>

# 删除远程分追
git push origin --delete <BranchName>

# 本地分支推上远程仓库（冒号前是本地分支的名字，冒号后是远端分支的名字）
git push origin <dev-name>:<div-name>

# 重命名分支
git branch -m old_name new_name
```

## 合并 test 分支

- **test** 随便合，不用在意 **commit** 记录

```shell
# 首先切换到 test 分支上
git checkout test
# 拉取最新的
git pull --rebase
# 合并分支
git merge <dev-name>
# 查看合并后的日志是否正确
git log --oneline
```

## 合并 master 分支

- 需要关注 **commit** 记录，尽量不产生 **merge** 信息

```shell
# 首先切换到 master 分支上
git checkout mater
# 拉取最新的
git pull --rebase
# 切回分支上
git checkout <dev-name>
# rebase 令 commit 在 master 前
git rebase master
# 解决冲突
# 切回 master 分支上
git checkout master
# 合并分支
git merge <dev-name>
```

> 如果要上线，还要 **push**，且打上 **tag**
>
> ```shell
> git push
> git tag vxxxx
> git push --tags
> git log --oneline
> ```

## stash

```shell
# 保存
git stash save '备注'

# 查看保存记录
git stash list

# 弹出最近的保存记录
git stash pop

# 缓存堆栈中的stash多次应用到工作目录中
git stash apply stash@{1}

# 有选择的删除stash
git stash drop stash@{1}

# 删除最近的stash
git stash drop

# 删除全部stash
git stash clear
```

## 用远程分支覆盖本地分支

```shell
git fetch --all
git reset --hard origin/<dev-name>
git pull
```

## 修改最近一次的 commit

1. 修改最近一次的提交信息

   ```shell
   git commit --amend
   ```

2. 与上次提交合并

   ```shell
   git commit --amend --no-edit
   ```

## 撤销

1. 撤销 git add 操作

   ```shell
   git reset HEAD   # 取消add操作并保留修改
   git checkout -- . # 会删除掉刚刚的修改内容
   ```

2. 撤销 git commit 操作

   ```shell
   git reset --soft <commit_id>   #可以回退到某个commit并保存之前的修改  <commit_id>从git log中取，取前7位即可    
   git reset --hard <commit_id>   #回退到某个commit不保留之前的修改
   ```

3. 撤销 git push 操作

   ```shell
   #这是git最安全、最基本的撤销场景，因为它并不会改变历史,所以你现在可以 git push 新的“反转” commit 来抵消你错误提交的 commit
   git revert <commit_id>
   ```

## reset

1. 回退一个版本,且会将暂存区的内容和本地已提交的内容全部恢复到未暂存的状态,不影响原来本地文件(未提交的也不受影响)

   ```shell
   git reset (--mixed) HEAD~1 
   ```

2. 回退一个版本,不清空暂存区,将已提交的内容恢复到暂存区,不影响原来本地的文件(未提交的也不受影响)

   ```shell
   git reset --soft HEAD~1
   ```

3. 回退一个版本,清空暂存区,将已提交的内容的版本恢复到本地,本地的文件也将被恢复的版本替换

   ```shell
   git reset --hard HEAD~1
   ```

   

